Full objective: "Given a scenario, apply common security techniques to
computing resources."

### Secure Baselines
- The security of an application should be well defined - everything follows this baseline
- Integrity measurements check for the secure baseline
- Establish baselines
	- Security baselines are often available from the manufacturer
	- Man OSes have extensive options - Windows has 3,000 group policies
- Deploy baselines
	- Usually managed through a centrally administered console
	- May require multiple deployment mechanisms, automation is key
- Maintain baselines
	- Many are best practices and won't change, but some require constant updates
		- New vulnerability, new app, new OS, etc.
	- Test and measure to avoid conflicts/contradictions
### Hardening Targets
- **No system is secure with default configurations!!!**
- Hardening guides: specific to software/platform, have best details
- Mobile devices: always connected mobile technologies
	- Updates are critical
	- Segmentation can protect data (company vs. user data)
	- Control with MDM (Mobile Device Manager)
- Workstations: user desktops and laptops
	- Need constant monitoring and updates (OSes, apps, etc.)
	- Automate monthly patches, probably an existing process
	- Remove unnecessary software
- Network infrastructure devices: switches, routers, firewalls, etc.
	- Purpose-built - embedded OS and applications
	- Configure authentication - DO NOT USE DEFAULTS
	- Check with manufacturer for security updates
- Cloud infrastructure
	- Use principle of least privilege (services, network settings, etc.)
	- Configure Endpoint Detection and Response (EDR) - all devices accessing the cloud should be secure
	- Always have backups between different providers (Cloud to Cloud / C2)
- Servers
	- Windows, Linux, etc.
	- Updates - OS updates / service packs, patches
	- User accounts - password policies, account permissions
	- Limit network access and employ authentication
	- Monitor and secure with anti-virus, -malware, etc.
- SCADA/ICS: industrial and manufacturing equipment
	- PC manages equipment
		- Power, refining, manufacturing
	- Distributed control systems - real time info, system control
	- Requires extensive segmentation, no access from outside
- Embedded systems: hardware and software designed for a specific function or operate as par of a larger system
	- Can be difficult to upgrade
	- Correct vulnerabilities, segment and firewall to prevent access
- RTOS (Real-Time Operating System): deterministic processing schedule
	- Industrial equipment, automobiles, military
	- Isolate to prevent access
	- Run with minimum services
	- Use secure communication
- IoT devices: heating and cooling, lighting, home automation, wearables, etc.
	- Weak defaults - CHANGE PASSWORDS
	- Deploy updates quickly
	- Segmentation - put on own LAN/VLAN
### Securing Wireless and Mobile
- Site survey: determine the existing the wireless landscape
	- Identify existing access points
	- Work around existing frequencies
	- Plan for ongoing surveys
	- Heat maps identify wireless signal strengths
- Wireless survey tools
	- Signal coverage, potential interference
	- Built-in tools sometimes exist in OSes, also 3rd-party tools
	- Spectrum analyzer shows all on particular freq.
- Mobile Device Manager (MDM)
	- Manage company-owned and user-owned mobile devices
	- Centralized management
	- Set policies on apps, data, etc.
	- Manage access control
- BYOD (bring your own device/tech)
	- Employee owns the device, difficult to secure
- COPE (corporate owned, personally enabled)
	- Company buys, used as corporate and personal
	- Org. keeps full control, info protected by corp. policies
	- CYOD (choose your own device) - choose your COPE
- Cellular networks (for mobile) - 4G LTE, 5G, etc.
	- Separate land into "cells" - antenna covers a cell with certain frequencies
	- Security concerns - traffic monitoring, location tracking, worldwide access to a mobile device
- Wi-Fi
	- Local network access = local problems
	- Same security concerns as other Wi-Fi devices
	- Data capture - encrypt!
	- On-path attack / MITM
	- Denial of service
- Bluetooth: PAN (personal area network), high speed comm. over short distances
	- Connects our mobile devices
	- Do not connect to unknown Bluetooth devices
### Wireless Security Settings
- Authenticate users before granting access, ensure all communication is confidential, verify integrity of all communication
	- Message Integrity Check (MIC)
- The WPA2 PSK problem: brute force problem
	- Listen to four-way handshake, capture hash
	- With hash, pre-shared key (PSK) can be brute forced
	- Some methods can even derive PSK without the handshake
	- Weak PSK is easier to brute force
		- Amazing GPUs and cloud-based password cracking
	- Once you have PSK, you have everyone's wireless key
- WPA3 and GCMP: Wi-Fi Protected Access 3 (WPA3)
	- GCMP block cipher mode (Galois/Counter Mode Protocol)
		- Stronger encryption
		- Data confidentiality with AES
		- MIC with GMAC (Galois Message Authentication Code)
- SAE (Simultaneous Authentication of Equals)
	- WPA3 changes the PSK auth process
	- Creates a shared session key without sending that key across the network
	- Diffie-Hellman derived key exchange with an authentication component
	- IEEE standard - the dragonfly handshake
- Wireless authentication methods
	- Credentials - shard password / PSK or centralized authentication (802.1X)
	- Configuration - part of the connection, prompted during connection process
- Wireless security modes
	- Open system - no auth
	- WPA3-Personal/-PSK - WPA2 or 3 with a pre-shared key
	- WPA3-Enterprise/-802.1X - authenticate users individually w/ server
- AAA framework
	- Identification - who do you claim to be (username)
	- Authentication - prove you are who you claim to be (password)
	- Authorization - what access do you have
	- Accounting - what did you use and for how long
	- ![](../Resources/4.0/aaa-auth.png)
- RADIUS (Remote Authentication Dial-in User Service) - common AAA protocol
	- Centralized authentication for users (user+pass)
	- Routers, switches, firewalls, servers, VPNs, 802.1X networks
- IEEE 802.1X - port-based Network Access Control (NAC)
	- Used in conjunction with an access database (RADIUS, LDAP, TACACS+)
- EAP (Extensible Authentication Protocol)
	- Many different ways to auth based on RFC standards
	- Integrates with 802.1X, prevents access until auth succeeds
- IEEE 802.1X and EAP
	- Supplicant - client
	- Authenticator - provides access
	- Authentication server - validates credentials
	- Supplicant talks to authenticator, authenticator talks to server
### Application Security
- Secure coding concepts - balance between time and quality
	- Quality Assurance (QA) process - you MUST test
	- Vulnerabilities will eventually be found and exploited
- Input validation - what is the expected input? Compare
	- Document all input methods
	- Check and correct all input (normalization)
	- Prevent SQL injections!
	- Fuzzers (random inputters) will find what you missed
- Secure cookies - info stored on computer by browser
	- Used for tracking, personalization, session management
	- Secure cookies have secure attribute set (only over HTTPS)
	- Sensitive info should NOT be stored in cookies
- Static code analyzers
	- Static Application Security Testing (SAST)
	- Many vulns found easily with static analysis (buffer overflows, injections, etc.)
	- But not everything (auth security, insecure crypto, etc.), don't rely on automatic static analysis
	- You still have to verify each finding, some may be false positives
- Code signing
	- Verifying application is the original and originated from the correct place
	- Application code can be digitally signed by developer, similar to website certificates
- Sandboxing - running the application in a safe test environment
	- Limit to fewest resources possible
	- Used in many different deployments - VMs, mobile devices, browser iframes, Windows User Account Control (UAC)
- Application security monitoring
	- Real-time information about usage, attacks, anomalies, etc.
	- View blocked attacks (injections, etc.)
	- Audit the logs to find info and hidden attacks

Next: [4.2 Asset Management](https://github.com/lercc46/Messer-Sec-Plus-Notes/blob/main/4.0%20Security%20Operations/4.2%20Asset%20Management.md)
