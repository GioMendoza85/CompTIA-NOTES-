Full objective: "Given a scenario, analyze indicators of malicious activity."

### An Overview of Malware
- Malware: malicious software that can gather information, show you advertising, encrypt your data, and overall ruin your day :(
- Malware types and methods
	- Virus
	- Worm
	- Ransomware
	- Trojan Horse
	- Rootkit, Keylogger, Spyware, Bloatware, Logic bomb, etc.
- How you get malware
	- Worm exploits a vulnerability, installs malware with a remote access backdoor
	- Your computer must run a program (email links, website pop-ups, drive-by download, and sometimes worms)
- Your data is valuable
	- Personal data (pictures, videos, tax documents)
	- Organizational data (planning documents, employee PII, financial info)
- Ransomware
	- Encrypt all data on computer and request money
	- Encrypted with a very strong symmetric or asymmetric key
	- Using an untraceable payment method like cryptocurrency (blockchain)
- Protecting against ransomware
	- Make backups
	- Keep OS and applications up to date
	- Keep anti-virus/-malware signatures up to date
### Viruses and Worms
- Malware that can reproduce itself
- Reproduces through filesystem or network
- Some cause immediate problems, some are invisible
- Anti-virus is very common, update signatures!!!
- Virus types
	- Program viruses
	- Boot sector viruses
	- Script viruses
	- Macro Viruses
- Fileless virus
	- Stealth attack, avoids detection
	- Operates in memory, never installed
- Worms
	- Malware that self-replicates without user interaction
	- Can take over systems very quickly
	- Firewalls and IDS/IPS can mitigate
	- WannaCry ![](../Resources/2.0/wannacry.png)
### Spyware and Bloatware
- Spyware
	- Spies on you for advertising, ID theft, etc.
	- Can trick you into installing 
	- Browser monitoring and keyloggers
- Protecting against spyware
	- Maintain anti-virus/-malware (latest signatures)
	- Always know what you're installing
	- Always have a backup
	- Run malware scans
- Bloatware
	- New device has OS necessary apps, but also unnecessary ones
	- May use storage and open device to vulnerabilities
- Removing uninstaller
	- Use built-in uninstaller
	- Some apps have their own uninstaller
	- Third-party uninstaller
### Other Malware Types
- Keyloggers
	- Logins, passwords, emails, etc.
	- Keystrokes captured and sent
	- Circumvents encryption
	- Other data logging: clipboard, screen, instant message
- Logic bomb
	- Waits for predefined event
	- Time or date, user event
	- Difficult to identify and recover
- Preventing a logic bomb
	- Formal change control
	- Electronic monitoring (IPS/IDS)
	- Constant auditing
- Rootkit
	- Originally a Unix technique
	- Modifies core system files (kernel)
	- Can be invisible to OS, has full control
- Finding and removing rootkits
	- Look for unusual
	- Use a remover specific to rootkit
	- Secure boot with UEFI
### Physical Attacks
- Old-school security, locks and guards
- If you have physical access to a server, you have full control
- "Door locks keep out the honest people"
- Brute force
	- Physical version... lol
	- Push through / break obstruction
- RFID cloning
	- Access badges, key fobs
	- Duplicators are cheap and effectives
	- A good reason for MFA
- Environmental attacks
	- Attack everything
	- Power monitoring
	- HVAC and humidity controls
	- Fire suppression
### Denial of Service
- Force a service to fail by overloading
- Take advantage of design failure or vulnerability
- Cause systems to be unavailable to cause a smoke screen
- "Friendly" DoS
	- Layer 2 loop without STP
	- Downloading large files over DSL line
	- Water line breaks
	- Pressing two generic remotes at the same time!
- Distributed Denial of Service (DDoS)
	- Launch an army of computers to bring down a service
	- Usually assembled via a botnet
		- At peak, Zeus infected >3.6 mil PCs
	- Asymmetric attack, attacker may have limited resources but inflates them
- DDoS reflection and amplification
	- Abuse specific devices/protocols that respond with more data then probed
	- DNS amplification (~15 --> ~1300 characters) ![](../Resources/2.0/dns-amplification.png)
	- DNS amplification DDoS ![](../Resources/2.0/dns-ddos.png)
### DNS Attacks
- DNS poisoning
	- Modify DNS server, less common
	- Modify client host file (DNS precedent)
	- Send a fake response to a valid DNS request
- Domain hijacking
	- Get access to domain registration, control where traffic flows
	- Brute force, social engineering, etc.
	- 8/22/2016, 36 domains of Brazilian bank changed, under control for 6 hours
- URL hijacking 
	- Sell a domain typo to the legitimate owner and redirect to a website with lots of advertisements, a competitor company, or phishing/malware (typosquatting)
### Wireless Attacks
- De-authentication attack (type of DoS)
- 802.11 management frames
	- Management features, important for operations
	- Original standards did not add protection
- Protecting against de-auth attacks
	- IEEE addressed with updates in 802.11ac
	- Important management frames encrypted, but not everything
- Radio frequency (RF) jamming
	- Denial of service
	- Transmit interfering wireless signals, more noise than actual data
	- Sometimes not intentional (microwave, fluorescent lights)
- Wireless jamming
	- Constant, random, legitimate, reactive (when someone transmits)
	- Needs to be somewhere close
	- "Fox hunting" -- hunting down a jam
### On-path Attack
- AKA Man-in-the-Middle
- Effectively invisible, redirects your traffic
- ARP poisoning
	- On-path in local subnet, ARP has no security
	- ![](../Resources/2.0/arp-poisoning.png)
- On-path browser attack
	- Malware/Trojan on host does the proxy work
	- AKA Man-in-the-Browser
	- Easy and looks encrypted
	- Malware waits for logins and sensitive info
### Replay Attacks
- Useful info transmitted over network
- Need access to raw network data
- Gathered info can help "replay" to pretend you're a trusted device
- Pass the hash
	- Client logs in to server, send user and hashed password over network
	- Attacker captures, replays to gain access to server
	- Avoid by using traffic encryption and/or salted hashed (with session ID, etc.)
- Browser cookies and session IDs
	- Cookies: info stored by your browser
	- Used for tracking, personalization, etc.
	- Could be considered a privacy risk, session IDs stored stored
- Session hijacking (Sidejacking)
	- Using an intercepted session ID to communicated with server
- Header manipulation
	- Gather info via Wireshark, Kismet
	- Modify headers (Tamper, Firesheep, Scapy)
	- Modify cookies (Cookies Manager+ on Firefox)
- Prevent session hijacking
	- Encrypt end-to-end (additional load on web server), force HTTPS/TLS
	- Encrypt end-to-somewhere, at least avoid over local wireless network (personal VPN)
### Malicious Code
- Exploiting a vulnerability
	- Social engineering, default creds, etc. don't require technical skills
	- You can still get in by exploiting with malicious code
- Can be executable, script, macro, worm, Trojan
- Can be protected by anti-everything, firewall, patches, etc.
- Examples
	- WannaCry ransomware
		- Executable exploited vuln in Windows SMBv1
	- British Airways XSS
		- 22 lines of malicious JS, info stolen
	- Estonian Central Health DB
		- SQL injection, healthcare info breached
### Application Attacks
- Injection attacks
	- Add your own info to a data stream
	- Enabled because of bad programming
	- HTML, SQL, XML, etc.
- Buffer overflow (prev.)
- Replay attack (prev.)
- Privilege escalation
	- Gain higher-level access to a system by exploiting a vulnerability
	- Higher-level = more capabilities
	- High-priority patches
	- Horizontal privilege (User A can access B resources) also useful
	- [CVE-2023-29336](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-29336)
- Mitigating privilege escalation
	- Employ patches as soon as possible, carefully of course
	- Update anti-everything software and signatures
	- Data Execution Prevention (only in executable areas can run)
	- Address space layout randomization (prevent buff overflow and known address)
- Cross-site request
	- Load info from other websites, HTML directs requests
	- The client and the server
		- Client side: renders page (HTML, JS)
		- Server side: performs requests (HTML, PHP)
	- Cross-site request forgery
		- One-click attack, session riding (XSRF, CSRF, "sea surf")
		- Takes advantage of the trust a web app has for user, requests made w/o knowledge
		- Significant development oversight
		- ![](../Resources/2.0/csrf.png)
- Directory traversal
	- Read files from web server that are outside of website's file directory
	- Web server software of web app code vulnerability
	- A "dot dot slash" (../) is an indicator, accessing parent directory
### Cryptographic Attacks
- Usually attacker doesn't have the "combination" so they attack the "safe"
- Birthday attack
	- In a classroom of 23 students, same birthday 50%
	- Digital equivalent is hash collision, find through brute force
	- Mitigate with a larger hash
- Collisions
	- Hash digests are *supposed* to be unique
	- MD5 is very susceptible, no longer used
- Downgrade attack
	- Force systems to downgrade security
	- SSL stripping
		- Combines on-path w/ downgrade
		- Browser page un-encrypted (HTTP)
		- ![](../Resources/2.0/ssl-stripping.png)
### Password Attacks
- Plaintext / unencrypted passwords
	- Some apps store passwords without any encryptions -- DON'T DO THIS
	- Use more secure software
- Hashing a password
	- Hashes represent data as a fixed-length string of text (digest/fingerprint)
	- One-way function with (hopefully) no collisions
	- Common way to store passwords (common hash is SHA-256)
- The password file -- varies between OSs, different syntax and algorithms
	- ![](../Resources/2.0/password-file.png)
- Spraying attack
	- Logging in with incorrect password can cause lockout, so common passwords are tried
	- Attack account with top three or so passwords, move on to next if nothing
	- No lockouts, alarms, or alerts - mini brute force
	- https://en.wikipedia.org/wiki/List_of_the_most_common_passwords
- Brute force - try every combination until hash matches
	- Might take some time with strong/slow hash
	- Online - keep trying API login, slow, most will lockout
	- Offline - obtain users and hashes, calculate and compare, large comp. req.
### Indicators of Compromise (IOC)
-  An event that indicates an intrusion, high confidence
- Common
	- Unusual amount of network activity
	- Change to file hashes
	- Irregular international traffic
	- Changes to DNS data
	- Uncommon login patterns
	- Spikes of read requests to certain files
- Account lockout
	- Credentials are not working, exceeded login attempts
	- Could also be administrative disabled, more confident indicator
	- Part of a larger plan, could lead to a social engineering attack
- Concurrent session usage
	- Cannot be in two places at the same time (duh)
	- Look for single account logged in from different locations
	- This could also be a remote desktop connection or automated process, however, so it's hard to track
- Blocked content
	- Attacker wants to be persistent, block security updates and patches
	- IOC could be removed access to security updates
- Impossible travel
	- Authentication logs (on/off)
	- One login at HQ, another international, huge IOC
	- Easy to identify
- Resource consumption
	- e.g. unusual bandwidth spikes outside office hours
	- Often first notification of real issue
- Resource inaccessibility
	- Server is down
	- Network disruption, cover for exploit
	- Server outage
	- Encrypted data (ransomware)
	- Brute force attack --> lockout
- Out-of-cycle logging
	- Occurs at unexpected time
	- Patch logs outside normal time/day
	- Firewall log activity (protocols/apps)
- Missing logs
	- Log information is evidence, so some during attack might be removed
	- Missing logs are also suspicious, IOC
- Published/documented
	- Sometimes, attack and exfiltration can go unnoticed
	- Only noticed when large data dump is released, obvious IOC

Next: [2.5 Mitigation Techniques](https://github.com/lercc46/Messer-Sec-Plus-Notes/blob/main/2.0%20Threats%2C%20Vulnerabilities%2C%20and%20Mitigations/2.5%20Mitigation%20Techniques.md)
