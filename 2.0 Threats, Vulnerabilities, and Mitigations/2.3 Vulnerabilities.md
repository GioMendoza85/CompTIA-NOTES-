Full objective: "Explain various types of vulnerabilities."

### Memory Injections
- Finding malware
	- Malware runs in memory
	- Memory contains running processes
		- DLLs, threads, buffers, etc.
	- Malware is hidden somewhere, either runs its own or injects itself into a legitimate process
- Memory injection - adding code into memory of an existing process
	- Get access to the data in that process
- DLL injection
	- Dynamic-linked library - widely used Windows libraries
	- Attackers inject a path to a malicious DLL, very popular
	- ![](../Resources/2.0/dll-injection.png)
### Buffer overflows
- Reference made outside memory buffer, revealing/overwriting existing memory
- Developers need to perform bound checking, large attack surface
- Not a simple exploit, looking for easy and repeatable buffer overflows
- Before overflow: ![](../Resources/2.0/buff-overflow-1.png)
- After overflow: ![](../Resources/2.0/buff-overflow-2.png)
### Race Conditions
- Two events happening almost simultaneously in a program, can end poorly or lead to vulnerabilities if not handled
- Time-of-check to time-of-use attack (TOCTOU)
	- Something might happen between these two moments
- ![](../Resources/2.0/race-cond-example.png)
- January 2004 - Mars rover "Spirit"
	- Reboot when a problem is identified ... problem is within the filesystem
	- Error repeats on reboot ... reboot loop ensues 
	- Fixed by deleting some erroneous software on the flash memory
- Pwn2Own Vancouver 2023
	- TOCTOU attack on Tesla Model 3 - against infotainment using Bluetooth
	- Elevated to root privileges, earned $100,000 and the Tesla
### Malicious Updates
- Update process can be injected with malicious code
- Always, ALWAYS have a good backup
- Install from trusted sources and check signatures
- Downloading and updating
	- Confirm the source
	- Visit the developer's site directly\
	- Many OSs will only allow signed apps
- Automatic updates
	- Often include security checks / signatures
	- Relatively trustworthy, but...
	- SolarWinds Orion supply chain attack
		- Attackers gained access to development system
		- Added their own code and gained access to gov agencies and companies
### Operating System Vulnerabilities
- Large target, foundational computing platform
- Remarkably complex, extremely large attack surface
- Patch Tuesday
	- 2nd Tuesday of each month
	- Microsoft releases windows CVE patches
	- [June 2024 (49 Microsoft CVEs)](https://msrc.microsoft.com/update-guide/releaseNote/2024-Jun)
- Best practices
	- Always update when available
	- Safely and carefully, of course - backup and test in sandboxes
### SQL Injection
- Code injection - adding your own information to a data stream
	- Side effect of bad program design
	- HTML, SQL, XML, LDAP, etc.
- SQL - structured query language, common relational DBMS language
- SQL injection (SQLi) - outside queries can reach internal database and display sensitive information, commonly on a web browser
- ![](../Resources/2.0/sql-injection.png)
### Cross-site scripting
- XSS (not to be confused with CSS - Cascading Style Sheets)
- Originally called this because of browser security flaws
- One of the most common web app vulnerabilities - commonly uses JS
- ![](../Resources/2.0/xss.png)
- Non-persistent (reflected) XSS attack
	- Website allows scripts to run in user input (search boxes, etc.)
	- Payload (script) returned as part of the HTML response
	- Victim tricked into sending malicious code to vulnerable web app, reflected back to victim's browser
- Persistent (stored) XSS attack
	- Attacker posts on social media or elsewhere with link or malicious payload (script)
	- Everyone gets the payload, no specific target
- Hackling a Subaru - June 2017, Aaron Guzman
	- During authentication w/ Subaru, users get a token that never expires
	- Can be used for any service request
	- Along with this, Subaru website front-end included an XSS vulnerability
- Protecting against XSS
	- Be incredibly careful when clicking untrusted links
	- Consider disabling JavaScript
	- Keep browser and applications updated
	- Validate (clean) input on web apps
### Hardware Vulnerabilities
- Surrounded by hardware / embedded systems, some with no accessible OS
- Potential security issues, everything is connected to the network (IoT)
- Firmware - the software inside of the hardware (OS, BIOS, UEFI, etc.)
	- Vendors are the only ones who can fix their hardware
	- Some don't care as much, take months or even years to supply a patch
- End of life (EOL) - manufacturer stops selling product
	- Support may continue, even security patches
	- End of service life (EOSL) - no longer selling or supporting (patching) device
- Legacy platforms - older OSs, apps, middleware (?)
	- May be running EOL/EOSL software
	- May require additional security protections (firewall rules, IPS signatures)
### Virtualization Vulnerabilities
- Quantity of resources vary between VMs
- Quite different, but also many similarities to physical machines
- VM escape protection
	- VM is self-contained, so no way out... right?
	- VM escape - breaking out and interacting with host OS/hardware
	- Pwn2Own March 2017
		- JS bug in Microsoft Edge --> code execution in Edge sandbox
		- Windows 10 kernel bug to compromise guest OS
		- Hardware simulation bug in VMWare --> move to other VMs in hypervisor
- Resource reuse
	- Hypervisor can be tasked with handing out more memory than is on the hardware, for example
	- If software outdated, some memory can be overwritten or read unintentionally and create security risks
### Cloud-specific vulnerabilities
- Lots of sensitive data, but 76% of companies are not using MFA and 63% of code is unpatched with a CVSS >= 7.0
- Attack the service
	- Denial of Service (DoS or DDoS)
	- Authentication bypass
	- Directory traversal
	- Remote code execution
- Attack the application
	- Web app attacks are on the rise (Log4j and Spring Cloud Function)
	- Cross-site scripting (XSS)
	- Out of bounds (memory) write
	- SQL injection
### Supply Chain Vulnerabilities
- Only as strong as your weakest link
- Supply chain risks
	- Contains many moving parts, large attack surface and lots of room for error
	- Raw material, supplier, manufacturer, distributor, customer, consumer
- Service providers
	- You can only control your own security posture, but not always a third-party
	- Can have access to internal services, so consider ongoing audits for providers
	- Target service provider attack - November 2013
		- Heating and AC firm in PA had a tech's VPN creds stolen via malware delivered in an email
		- Firm was a service provider for Target, network wide open and every cash register was infected
		- Months later it was discovered, but 40 million credit cards stolen
- Hardware providers - can you trust your new anything?
	- Use a small supplier base
	- Strict controls over policies and procedures
	- Cisco or not Cisco?
		- All network traffic flows through switches and routers
		- July 2022 Homeland Security arrests reseller CEO, $1 billion of counterfeit Cisco products creating over 30 different companies since 2013
		- Made in China and distributed, started breaking / catching on fire
- Software providers
	- Check signatures on initial installation
	- Ensure security and authenticity of updates and patches
	- Open source isn't immune
	- SolarWinds Orion supply chain attack
		- Used by 18,000 customers including Fortune 500 and US Gov
		- Software updates were compromised from the inside
		- Compromise March and June 2020, not found until December 2020
### Misconfiguration Vulnerabilities
- Open permissions
	- Easy to accidentally leave a door open - June 2017, 14 mil Verizon records exposed because a third-party just left an Amazon S3 data repo sitting open, thankfully it was found by a researcher
	- Increasingly common with cloud storage
- Unsecured admin accounts
	- Linux root / Windows Administrator
	- Can be a misconfiguration or intentional malicious configuration (bad password)
	- Disable direct login to the root account (su/sudo, run as Admin)
- Insecure protocols
	- Some protocols like Telnet, FTP, SMTP, IMAP send unencrypted traffic
	- Verify with a packet capture
	- Use encrypted versions like SSH, SFTP, IMAPS, etc.
	- [DEF CON Wall of Sheep](https://www.wallofsheep.com/pages/wall-of-sheep)
- Default settings
	- Every app, device, etc. has a default login
	- Mirai botnet - took advantage of IoT default configs, released as open source software
- Open ports and services
	- Often managed with a firewall
	- Firewall rulesets can be complex
	- Always test and audit
### Mobile Device Vulnerabilities
- Challenging to secure - small, in motion, containing sensitive data, connected
- Jailbreaking/rooting
	- Purpose-built systems without access to OS, but rooting (Android) and jailbreaking (iOS) can allow OS/hardware access to install new firmware
	- Uncontrolled access, mobile device manager (MDM) becomes useless
- Sideloading
	- One malicious app can cause a breach
	- On most modern phones, all installations are managed by a store
	- Sideloading (installing your own software) circumvents this security
### Zero-day Vulnerabilities
- Many apps have unfound vulnerabilities, can be found by researchers or attackers
- If first found by attackers, they are zero-day vulnerabilities
	- Vendor has no idea the vulnerability exists, no patch
	- Zero-day attacks use these exploits
	- [Common Vulnerabilities and Exposures (CVE)](https://cve.mitre.org/)
- April 2023 - Chrome zero-day memory corruption, sandbox escape
- May 2023 - Microsoft zero-day secure boot, UEFI self-signed code
- May 2023 - iOS and iPadOS sandbox escape, info disclosure, code execution

Next: [2.4 Indicators of Malicious Activity](https://github.com/lercc46/Messer-Sec-Plus-Notes/blob/main/2.0%20Threats%2C%20Vulnerabilities%2C%20and%20Mitigations/2.4%20Indicators%20of%20Malicious%20Activity.md)
